{% extends "inner.html" %}
{% load i18n two_factor %}

{% block workspace %}
<header class="heading">
  <h1>{% block title %}{% trans "Account Security" %}{% endblock %}</h1>
</header>

<div class='fields tfa'>

  {% if default_device %}
  
    <p class='ok'>Two-factor authentication is enabled for your account.</p>

    <h2>Primary Authentication Method</h2>

    {% if default_device_type == 'TOTPDevice' %}
      <p><b>Primary method:</b> verification codes will be generated by your token generator app.</p>
    {% elif default_device_type == 'PhoneDevice' %}
      <p><b>Primary method:</b> {{ default_device|device_action }}</p>
    {% elif default_device_type == 'RemoteYubikeyDevice' %}
      <p>Tokens will be generated by your YubiKey.</p>
    {% endif %}

    {% if available_phone_methods and False %}
      <h2>Backup Phone Numbers</h2>
      {% if backup_phones %}
      <p>If your primary method is not available, we are able to
        send backup tokens to the phone numbers listed below.</p>
        <ul>
        {% for phone in backup_phones %}
          <li>
            {{ phone|device_action }}
            <form method="post" action="{% url 'two_factor:phone_delete' phone.id %}"
            onsubmit="return confirm('Are you sure?')">
              {% csrf_token %}
            <button class="btn btn-gray btn-asize" type="submit">{% trans "Unregister" %}</button>
          </form>
        </li>
        {% endfor %}
        </ul>
      {% endif %}
      <p><a href="{% url 'two_factor:phone_create' %}" 
        class="btn btn-asize">{% trans "Add Phone Number" %}</a></p>
    {% endif %}

    <h2>{% trans "Backup Verification Codes" %}</h2>
    <p>
      If you don't have any device with you, you can access your account using backup codes.
    </p>
    <p>
        You have <b>{{ backup_tokens }}</b> backup codes remaining.
    </p>
    <p><a href="{% url 'two_factor:backup_tokens' %}" 
          class="btn btn-info">{% trans "Show Codes" %}</a></p>

    <h2>{% trans "Disable Two-Factor Authentication" %}</h2>
    <p>However we strongly discourage you to do so, you can
      also disable two-factor authentication for your account.</p>
    <p><a href="{% url 'two_factor:disable' %}"
      class="btn btn-gray btn-asize">{% trans "Disable Two-Factor Authentication" %}</a></p>

    {% elif True %}
      <p>Two-factor authentication security feature was enabled by administrator,
        but not yet configured for your account. 
        <br>
        To continue please, enable two-factor authentication for enhanced account security.</p>
      <p><a href="{% url 'two_factor:setup' %}" class="btn btn-asize">
        {% trans "Enable Two-Factor Authentication" %}</a>
      </p>

   {% else %}
    <p>Two-factor authentication is not enabled for your
      account. Enable two-factor authentication for enhanced account
      security.</p>
  {% endif %}
</div>
{% endblock %}
